CREATE OR REPLACE FUNCTION bill (clientInput VARCHAR2, monthInput VARCHAR2, productInput VARCHAR2) RETURN NUMBER

IS

		costsMovies NUMBER;
		costsSeries NUMBER;
		i NUMBER;

CURSOR bill_movie IS
		SELECT clientId,contractId, product_name,(tap_cost*2) as tap_costMovies,month FROM(
		SELECT clientId, contractId, contract_type, month FROM(
		SELECT title,  contractId, to_char(view_datetime, 'MON-YYYY') AS month
		FROM taps_movies)
		NATURAL JOIN contracts) JOIN products ON product_name=contract_type;

CURSOR bill_serie IS
		SELECT clientId,contractId, product_name,tap_cost as tap_costSeries,month FROM(
		SELECT clientId, contractId, contract_type, month FROM(
		SELECT title,  contractId, to_char(view_datetime, 'MON-YYYY') AS month
		FROM taps_series)
		NATURAL JOIN contracts) JOIN products ON product_name=contract_type;

BEGIN 
		FOR (clientInput AND monthInput AND productInput) IN bill_movie
		LOOP
			costsMovies = tap_costMovies + costsMovies;
		END LOOP;
		RETURN costsMovies;
END;
/

declare
result number;
begin
result:=bill('hola','pole','uouo');
end;
